I = rgb2gray(imread ('/home/azizax/Documents/fci/Second/ComputerVision/Tasks/Hough-LineDetection/lines.jpg'));
I_edgeDetected_byCanny = edge(I,'canny');

[rows, cols] = size(I);

step = 18;  
pi=180;
rhomax = 2*sqrt(rows^2 + cols^2);   

matrix_of_R_and_Theta = zeros(round(pi/step), round(rhomax/step));
matrix_of_x_values = zeros(round(pi/step), round(rhomax/step));
matrix_of_y_values = zeros(round(pi/step), round(rhomax/step));
drho =  2*rhomax/(step-1);   
dtheta = pi/step;                
theta = 10:+dtheta:pi;
[x,y,s] = find(I_edgeDetected_byCanny);
for index = 1:length(s)
            if s(index)              
                for thetaindex = 1:round(pi/step)
                    rho = x(index)*cos(theta(thetaindex)) + y(index)*sin(theta(thetaindex));
                    rhoindex = round((rho/drho)+((rhomax/step)/2)); %+R
                    
                    matrix_of_R_and_Theta(thetaindex,rhoindex) = matrix_of_R_and_Theta(thetaindex,rhoindex) + 1;
                    matrix_of_x_values(thetaindex,rhoindex)=x(index);
                    matrix_of_y_values(thetaindex,rhoindex)=y(index);
                end
            end
end

ToBeLine = 50;
ToBePeak = 100;
[result_rows,result_cols] =size(matrix_of_R_and_Theta);
imshow(I)
hold on
for i=1:result_rows
    for j=1:result_cols
       
        if matrix_of_R_and_Theta(i,j)>=ToBeLine
            plot(matrix_of_x_values(i,j),matrix_of_y_values(i,j), 'r.','MarkerSize',50)
        end
    end
end

for i=1:result_rows
    for j=1:result_cols
        if matrix_of_R_and_Theta(i,j)>=ToBePeak && matrix_of_R_and_Theta(i,j)<= ToBeLine
            plot(matrix_of_x_values(i,j),matrix_of_y_values(i,j), 'b.','MarkerSize',80)
        end
    end
end
hold off



